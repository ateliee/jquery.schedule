{"version":3,"file":"jq.schedule.min.js","sources":["js/jq.schedule.js"],"sourcesContent":["\"use strict\";\n\n(function ($) {\n  'use strict';\n\n  const PLUGIN_NAME = 'jqSchedule';\n  var methods = {\n    /**\n     *\n     * @param {string} str\n     * @returns {number}\n     */\n    calcStringTime: function (str) {\n      let slice = str.split(':');\n      let h = Number(slice[0]) * 60 * 60;\n      let i = Number(slice[1]) * 60;\n      return h + i;\n    },\n    /**\n     *\n     * @param {number} val\n     * @returns {string}\n     */\n    formatTime: function (val) {\n      let i1 = val % 3600;\n      let h = '' + Math.floor(val / 36000) + Math.floor(val / 3600 % 10);\n      let i = '' + Math.floor(i1 / 600) + Math.floor(i1 / 60 % 10);\n      return h + ':' + i;\n    },\n    /**\n     * 設定データの保存\n     *\n     * @param {Options} data\n     * @returns {*}\n     */\n    _saveSettingData: function (data) {\n      return this.data(PLUGIN_NAME + 'Setting', data);\n    },\n    /**\n     * 設定データの取得\n     *\n     * @returns Options\n     */\n    _loadSettingData: function () {\n      return this.data(PLUGIN_NAME + 'Setting');\n    },\n    /**\n     * 保存データの保存\n     *\n     * @param {SaveData} data\n     * @returns {*}\n     */\n    _saveData: function (data) {\n      let d = $.extend({\n        tableStartTime: 0,\n        tableEndTime: 0,\n        schedule: [],\n        timeline: []\n      }, data);\n      return this.data(PLUGIN_NAME, d);\n    },\n    /**\n     * 保存データの取得\n     *\n     * @returns SaveData\n     */\n    _loadData: function () {\n      return this.data(PLUGIN_NAME);\n    },\n    /**\n     * スケジュールの取得\n     *\n     * @returns ScheduleData[]\n     */\n    scheduleData: function () {\n      let $this = $(this);\n      let saveData = methods._loadData.apply($this);\n      if (saveData) {\n        return saveData.schedule;\n      }\n      return [];\n    },\n    /**\n     * get timelineData\n     * @returns {any[]}\n     */\n    timelineData: function () {\n      let $this = $(this);\n      let saveData = methods._loadData.apply($this);\n      let data = [];\n      let i;\n      for (i in saveData.timeline) {\n        data[i] = saveData.timeline[i];\n        data[i].schedule = [];\n      }\n      for (i in saveData.schedule) {\n        var d = saveData.schedule[i];\n        if (typeof d.timeline === 'undefined') {\n          continue;\n        }\n        if (typeof data[d.timeline] === 'undefined') {\n          continue;\n        }\n        data[d.timeline].schedule.push(d);\n      }\n      return data;\n    },\n    /**\n     * reset data\n     */\n    resetData: function () {\n      return this.each(function () {\n        let $this = $(this);\n        let saveData = methods._loadData.apply($this);\n        saveData.schedule = [];\n        methods._saveData.apply($this, [saveData]);\n        $this.find('.sc_bar').remove();\n        for (var i in saveData.timeline) {\n          saveData.timeline[i].schedule = [];\n          methods._resizeRow.apply($this, [i, 0]);\n        }\n        methods._saveData.apply($this, [saveData]);\n      });\n    },\n    /**\n     * add schedule data\n     *\n     * @param {number} timeline\n     * @param {object} data\n     * @returns {methods}\n     */\n    addSchedule: function (timeline, data) {\n      return this.each(function () {\n        let $this = $(this);\n        let d = {\n          start: data.start,\n          end: data.end,\n          startTime: methods.calcStringTime(data.start),\n          endTime: methods.calcStringTime(data.end),\n          text: data.text,\n          timeline: timeline\n        };\n        if (data.data) {\n          d.data = data.data;\n        }\n        methods._addScheduleData.apply($this, [timeline, d]);\n        methods._resetBarPosition.apply($this, [timeline]);\n      });\n    },\n    /**\n     * add schedule data\n     *\n     * @param {number} timeline\n     * @param {object} data\n     * @returns {methods}\n     */\n    addRow: function (timeline, data) {\n      return this.each(function () {\n        let $this = $(this);\n        methods._addRow.apply($this, [timeline, data]);\n      });\n    },\n    /**\n     * clear row\n     *\n     * @returns {methods}\n     */\n    resetRowData: function () {\n      return this.each(function () {\n        let $this = $(this);\n        let data = methods._loadData.apply($this);\n        data.schedule = [];\n        data.timeline = [];\n        methods._saveData.apply($this, [data]);\n        $this.find('.sc_bar').remove();\n        $this.find('.timeline').remove();\n        $this.find('.sc_data').height(0);\n      });\n    },\n    /**\n     * clear row\n     *\n     * @param {object} data\n     * @returns {methods}\n     */\n    setRows: function (data) {\n      return this.each(function () {\n        let $this = $(this);\n        methods.resetRowData.apply($this, []);\n        for (var timeline in data) {\n          methods.addRow.apply($this, [timeline, data[timeline]]);\n        }\n      });\n    },\n    /**\n     * switch draggable\n     * @param {boolean} enable\n     */\n    setDraggable: function (enable) {\n      return this.each(function () {\n        let $this = $(this);\n        let setting = methods._loadSettingData.apply($this);\n        if (enable !== setting.draggable) {\n          setting.draggable = enable;\n          methods._saveSettingData.apply($this, setting);\n          if (enable) {\n            $this.find('.sc_bar').draggable('enable');\n          } else {\n            $this.find('.sc_bar').draggable('disable');\n          }\n        }\n      });\n    },\n    /**\n     * switch resizable\n     * @param {boolean} enable\n     */\n    setResizable: function (enable) {\n      return this.each(function () {\n        let $this = $(this);\n        let setting = methods._loadSettingData.apply($this);\n        if (enable !== setting.resizable) {\n          setting.resizable = enable;\n          methods._saveSettingData.apply($this, setting);\n          if (enable) {\n            $this.find('.sc_bar').resizable('enable');\n          } else {\n            $this.find('.sc_bar').resizable('disable');\n          }\n        }\n      });\n    },\n    /**\n     * 現在のタイムライン番号を取得\n     *\n     * @param node\n     * @param top\n     * @returns {number}\n     */\n    _getTimeLineNumber: function (node, top) {\n      let $this = $(this);\n      let setting = methods._loadSettingData.apply($this);\n      let num = 0;\n      let n = 0;\n      let tn = Math.ceil(top / (setting.timeLineY + setting.timeLinePaddingTop + setting.timeLinePaddingBottom));\n      for (var i in setting.rows) {\n        let r = setting.rows[i];\n        let tr = 0;\n        if (typeof r.schedule === 'object') {\n          tr = r.schedule.length;\n        }\n        if (node && node.timeline) {\n          tr++;\n        }\n        n += Math.max(tr, 1);\n        if (n >= tn) {\n          break;\n        }\n        num++;\n      }\n      return num;\n    },\n    /**\n     * 背景データ追加\n     *\n     * @param {ScheduleData} data\n     */\n    _addScheduleBgData: function (data) {\n      return this.each(function () {\n        let $this = $(this);\n        let setting = methods._loadSettingData.apply($this);\n        let saveData = methods._loadData.apply($this);\n        let st = Math.ceil((data.startTime - saveData.tableStartTime) / setting.widthTime);\n        let et = Math.floor((data.endTime - saveData.tableStartTime) / setting.widthTime);\n        let $bar = $('<div class=\"sc_bgBar\"><span class=\"text\"></span></div>');\n        $bar.css({\n          left: st * setting.widthTimeX,\n          top: 0,\n          width: (et - st) * setting.widthTimeX,\n          height: $this.find('.sc_main .timeline').eq(data.timeline).height()\n        });\n        if (data.text) {\n          $bar.find('.text').text(data.text);\n        }\n        if (data.class) {\n          $bar.addClass(data.class);\n        }\n        // $element.find('.sc_main').append($bar);\n        $this.find('.sc_main .timeline').eq(data.timeline).append($bar);\n      });\n    },\n    /**\n     * スケジュール追加\n     *\n     * @param timeline\n     * @param {ScheduleData} d\n     * @returns {number}\n     */\n    _addScheduleData: function (timeline, d) {\n      let data = d;\n      data.startTime = data.startTime ? data.startTime : methods.calcStringTime(data.start);\n      data.endTime = data.endTime ? data.endTime : methods.calcStringTime(data.end);\n      return this.each(function () {\n        let $this = $(this);\n        let setting = methods._loadSettingData.apply($this);\n        let saveData = methods._loadData.apply($this);\n        let st = Math.ceil((data.startTime - saveData.tableStartTime) / setting.widthTime);\n        let et = Math.floor((data.endTime - saveData.tableStartTime) / setting.widthTime);\n        let $bar = $('<div class=\"sc_bar\"><span class=\"head\"><span class=\"time\"></span></span><span class=\"text\"></span></div>');\n        let stext = methods.formatTime(data.startTime);\n        let etext = methods.formatTime(data.endTime);\n        let snum = methods._getScheduleCount.apply($this, [data.timeline]);\n        $bar.css({\n          left: st * setting.widthTimeX,\n          top: snum * setting.timeLineY + setting.timeLinePaddingTop,\n          width: (et - st) * setting.widthTimeX,\n          height: setting.timeLineY\n        });\n        $bar.find('.time').text(stext + '-' + etext);\n        if (data.text) {\n          $bar.find('.text').text(data.text);\n        }\n        if (data.class) {\n          $bar.addClass(data.class);\n        }\n        // $this.find('.sc_main').append($bar);\n        var $row = $this.find('.sc_main .timeline').eq(timeline);\n        $row.append($bar);\n        // データの追加\n        saveData.schedule.push(data);\n        methods._saveData.apply($this, [saveData]);\n        // コールバックがセットされていたら呼出\n        if (setting.onAppendSchedule) {\n          setting.onAppendSchedule.apply($this, [$bar, data]);\n        }\n        // key\n        var key = saveData.schedule.length - 1;\n        $bar.data('sc_key', key);\n        $bar.on('mouseup', function () {\n          // コールバックがセットされていたら呼出\n          if (setting.onClick) {\n            if ($(this).data('dragCheck') !== true && $(this).data('resizeCheck') !== true) {\n              let $n = $(this);\n              let scKey = $n.data('sc_key');\n              setting.onClick.apply($this, [$n, saveData.schedule[scKey]]);\n            }\n          }\n        });\n        var $node = $this.find('.sc_bar');\n        let currentNode = null;\n        // move node.\n        $node.draggable({\n          grid: [setting.widthTimeX, 1],\n          containment: $this.find('.sc_main'),\n          helper: 'original',\n          start: function (event, ui) {\n            let node = {};\n            node.node = this;\n            node.offsetTop = ui.position.top;\n            node.offsetLeft = ui.position.left;\n            node.currentTop = ui.position.top;\n            node.currentLeft = ui.position.left;\n            node.timeline = methods._getTimeLineNumber.apply($this, [currentNode, ui.position.top]);\n            node.nowTimeline = node.timeline;\n            currentNode = node;\n          },\n          /**\n           *\n           * @param {Event} event\n           * @param {function} ui\n           * @returns {boolean}\n           */\n          drag: function (event, ui) {\n            $(this).data('dragCheck', true);\n            if (!currentNode) {\n              return false;\n            }\n            let $moveNode = $(this);\n            let scKey = $moveNode.data('sc_key');\n            let timelineNum = methods._getTimeLineNumber.apply($this, [currentNode, ui.position.top]);\n            // eslint-disable-next-line no-param-reassign\n            ui.position.left = Math.floor(ui.position.left / setting.widthTimeX) * setting.widthTimeX;\n            if (currentNode.nowTimeline !== timelineNum) {\n              // 現在のタイムライン\n              currentNode.nowTimeline = timelineNum;\n            }\n            currentNode.currentTop = ui.position.top;\n            currentNode.currentLeft = ui.position.left;\n            // テキスト変更\n            methods._rewriteBarText.apply($this, [$moveNode, saveData.schedule[scKey]]);\n            return true;\n          },\n          // 要素の移動が終った後の処理\n          stop: function () {\n            $(this).data('dragCheck', false);\n            currentNode = null;\n            let $n = $(this);\n            let scKey = $n.data('sc_key');\n            let x = $n.position().left;\n            // var w = $n.width();\n            let start = saveData.tableStartTime + Math.floor(x / setting.widthTimeX) * setting.widthTime;\n            // var end = saveData.tableStartTime + (Math.floor((x + w) / setting.widthTimeX) * setting.widthTime);\n            let end = start + (saveData.schedule[scKey].endTime - saveData.schedule[scKey].startTime);\n            saveData.schedule[scKey].start = methods.formatTime(start);\n            saveData.schedule[scKey].end = methods.formatTime(end);\n            saveData.schedule[scKey].startTime = start;\n            saveData.schedule[scKey].endTime = end;\n            // コールバックがセットされていたら呼出\n            if (setting.onChange) {\n              setting.onChange.apply($this, [$n, saveData.schedule[scKey]]);\n            }\n          }\n        });\n        let resizableHandles = ['e'];\n        if (setting.resizableLeft) {\n          resizableHandles.push('w');\n        }\n        $node.resizable({\n          handles: resizableHandles.join(','),\n          grid: [setting.widthTimeX, setting.timeLineY - setting.timeBorder],\n          minWidth: setting.widthTimeX,\n          containment: $this.find('.sc_main_scroll'),\n          start: function () {\n            let $n = $(this);\n            $n.data('resizeCheck', true);\n          },\n          resize: function (ev, ui) {\n            // box-sizing: border-box; に対応\n            ui.element.height(ui.size.height);\n            ui.element.width(ui.size.width);\n          },\n          // 要素の移動が終った後の処理\n          stop: function () {\n            let $n = $(this);\n            let scKey = $n.data('sc_key');\n            let x = $n.position().left;\n            let w = $n.outerWidth();\n            let start = saveData.tableStartTime + Math.floor(x / setting.widthTimeX) * setting.widthTime;\n            let end = saveData.tableStartTime + Math.floor((x + w) / setting.widthTimeX) * setting.widthTime;\n            let timelineNum = saveData.schedule[scKey].timeline;\n            saveData.schedule[scKey].start = methods.formatTime(start);\n            saveData.schedule[scKey].end = methods.formatTime(end);\n            saveData.schedule[scKey].startTime = start;\n            saveData.schedule[scKey].endTime = end;\n\n            // 高さ調整\n            methods._resetBarPosition.apply($this, [timelineNum]);\n            // テキスト変更\n            methods._rewriteBarText.apply($this, [$n, saveData.schedule[scKey]]);\n            $n.data('resizeCheck', false);\n            // コールバックがセットされていたら呼出\n            if (setting.onChange) {\n              setting.onChange.apply($this, [$n, saveData.schedule[scKey]]);\n            }\n          }\n        });\n        if (setting.draggable === false) {\n          $node.draggable('disable');\n        }\n        if (setting.resizable === false) {\n          $node.resizable('disable');\n        }\n        return key;\n      });\n    },\n    /**\n     * スケジュール数の取得\n     *\n     * @param {number} n row number\n     * @returns {number}\n     */\n    _getScheduleCount: function (n) {\n      let $this = $(this);\n      let saveData = methods._loadData.apply($this);\n      let num = 0;\n      for (let i in saveData.schedule) {\n        if (saveData.schedule[i].timeline === n) {\n          num++;\n        }\n      }\n      return num;\n    },\n    /**\n     * add rows\n     *\n     * @param timeline\n     * @param row\n     */\n    _addRow: function (timeline, row) {\n      return this.each(function () {\n        let $this = $(this);\n        let setting = methods._loadSettingData.apply($this);\n        let saveData = methods._loadData.apply($this);\n        let id = $this.find('.sc_main .timeline').length;\n        let html;\n        html = '';\n        html += '<div class=\"timeline\"></div>';\n        let $data = $(html);\n        if (row.title) {\n          $data.append('<span class=\"timeline-title\">' + row.title + '</span>');\n        }\n        if (row.subtitle) {\n          $data.append('<span class=\"timeline-subtitle\">' + row.subtitle + '</span>');\n        }\n        // event call\n        if (setting.onInitRow) {\n          setting.onInitRow.apply($this, [$data, row]);\n        }\n        $this.find('.sc_data_scroll').append($data);\n        html = '';\n        html += '<div class=\"timeline\"></div>';\n        let $timeline = $(html);\n        for (var t = saveData.tableStartTime; t < saveData.tableEndTime; t += setting.widthTime) {\n          var $tl = $('<div class=\"tl\"></div>');\n          $tl.outerWidth(setting.widthTimeX);\n          $tl.data('time', methods.formatTime(t));\n          $tl.data('timeline', timeline);\n          $timeline.append($tl);\n        }\n        // クリックイベント\n        // left click\n        $timeline.find('.tl').on('click', function () {\n          if (setting.onScheduleClick) {\n            setting.onScheduleClick.apply($this, [this, $(this).data('time'), $(this).data('timeline'), saveData.timeline[$(this).data('timeline')]]);\n          }\n        });\n        // right click\n        $timeline.find('.tl').on('contextmenu', function () {\n          if (setting.onScheduleClick) {\n            setting.onScheduleClick.apply($this, [this, $(this).data('time'), $(this).data('timeline'), saveData.timeline[$(this).data('timeline')]]);\n          }\n          return false;\n        });\n        $this.find('.sc_main').append($timeline);\n        saveData.timeline[timeline] = row;\n        methods._saveData.apply($this, [saveData]);\n        if (row.class && row.class !== '') {\n          $this.find('.sc_data .timeline').eq(id).addClass(row.class);\n          $this.find('.sc_main .timeline').eq(id).addClass(row.class);\n        }\n        // スケジュールタイムライン\n        if (row.schedule) {\n          for (var i in row.schedule) {\n            var bdata = row.schedule[i];\n            var s = bdata.start ? bdata.start : methods.calcStringTime(bdata.startTime);\n            var e = bdata.end ? bdata.end : methods.calcStringTime(bdata.endTime);\n            var data = {};\n            data.start = s;\n            data.end = e;\n            if (bdata.text) {\n              data.text = bdata.text;\n            }\n            data.timeline = timeline;\n            data.data = {};\n            if (bdata.data) {\n              data.data = bdata.data;\n            }\n            methods._addScheduleData.apply($this, [id, data]);\n          }\n        }\n        // 高さの調整\n        methods._resetBarPosition.apply($this, [id]);\n        $this.find('.sc_main .timeline').eq(id).droppable({\n          accept: '.sc_bar',\n          drop: function (ev, ui) {\n            let node = ui.draggable;\n            let scKey = node.data('sc_key');\n            let nowTimelineNum = saveData.schedule[scKey].timeline;\n            let timelineNum = $this.find('.sc_main .timeline').index(this);\n            // タイムラインの変更\n            saveData.schedule[scKey].timeline = timelineNum;\n            node.appendTo(this);\n            // 高さ調整\n            methods._resetBarPosition.apply($this, [nowTimelineNum]);\n            methods._resetBarPosition.apply($this, [timelineNum]);\n          }\n        });\n        // コールバックがセットされていたら呼出\n        if (setting.onAppendRow) {\n          $this.find('.sc_main .timeline').eq(id).find('.sc_bar').each(function () {\n            let $n = $(this);\n            let scKey = $n.data('sc_key');\n            setting.onAppendRow.apply($this, [$n, saveData.schedule[scKey]]);\n          });\n        }\n      });\n    },\n    /**\n     * テキストの変更\n     *\n     * @param {jQuery} node\n     * @param {Object} data\n     */\n    _rewriteBarText: function (node, data) {\n      return this.each(function () {\n        let $this = $(this);\n        let setting = methods._loadSettingData.apply($this);\n        let saveData = methods._loadData.apply($this);\n        let x = node.position().left;\n        // var w = node.width();\n        let start = saveData.tableStartTime + Math.floor(x / setting.widthTimeX) * setting.widthTime;\n        // var end = saveData.tableStartTime + (Math.floor((x + w) / setting.widthTimeX) * setting.widthTime);\n        let end = start + (data.endTime - data.startTime);\n        let html = methods.formatTime(start) + '-' + methods.formatTime(end);\n        $(node).find('.time').html(html);\n      });\n    },\n    /**\n     *\n     * @param {Number} n\n     */\n    _resetBarPosition: function (n) {\n      return this.each(function () {\n        let $this = $(this);\n        let setting = methods._loadSettingData.apply($this);\n        // 要素の並び替え\n        let $barList = $this.find('.sc_main .timeline').eq(n).find('.sc_bar');\n        let codes = [],\n          check = [];\n        let h = 0;\n        let $e1, $e2;\n        let c1, c2, s1, s2, e1, e2;\n        let i;\n        for (i = 0; i < $barList.length; i++) {\n          codes[i] = {\n            code: i,\n            x: $($barList[i]).position().left\n          };\n        }\n        // ソート\n        codes.sort(function (a, b) {\n          if (a.x < b.x) {\n            return -1;\n          }\n          if (a.x > b.x) {\n            return 1;\n          }\n          return 0;\n        });\n        for (i = 0; i < codes.length; i++) {\n          c1 = codes[i].code;\n          $e1 = $($barList[c1]);\n          for (h = 0; h < check.length; h++) {\n            let next = false;\n            for (var j = 0; j < check[h].length; j++) {\n              c2 = check[h][j];\n              $e2 = $($barList[c2]);\n              s1 = $e1.position().left;\n              e1 = $e1.position().left + $e1.outerWidth();\n              s2 = $e2.position().left;\n              e2 = $e2.position().left + $e2.outerWidth();\n              if (s1 < e2 && e1 > s2) {\n                next = true;\n                continue;\n              }\n            }\n            if (!next) {\n              break;\n            }\n          }\n          if (!check[h]) {\n            check[h] = [];\n          }\n          $e1.css({\n            top: h * setting.timeLineY + setting.timeLinePaddingTop\n          });\n          check[h][check[h].length] = c1;\n        }\n        // 高さの調整\n        methods._resizeRow.apply($this, [n, check.length]);\n      });\n    },\n    /**\n     *\n     * @param n\n     * @param height\n     */\n    _resizeRow: function (n, height) {\n      return this.each(function () {\n        let $this = $(this);\n        let setting = methods._loadSettingData.apply($this);\n        let h = Math.max(height, 1);\n        $this.find('.sc_data .timeline').eq(n).outerHeight(h * setting.timeLineY + setting.timeLineBorder + setting.timeLinePaddingTop + setting.timeLinePaddingBottom);\n        $this.find('.sc_main .timeline').eq(n).outerHeight(h * setting.timeLineY + setting.timeLineBorder + setting.timeLinePaddingTop + setting.timeLinePaddingBottom);\n        $this.find('.sc_main .timeline').eq(n).find('.sc_bgBar').each(function () {\n          $(this).outerHeight($(this).closest('.timeline').outerHeight());\n        });\n        $this.find('.sc_data').outerHeight($this.find('.sc_main_box').outerHeight());\n      });\n    },\n    /**\n     * resizeWindow\n     */\n    _resizeWindow: function () {\n      return this.each(function () {\n        let $this = $(this);\n        let setting = methods._loadSettingData.apply($this);\n        let saveData = methods._loadData.apply($this);\n        let scWidth = $this.width();\n        let scMainWidth = scWidth - setting.dataWidth - setting.verticalScrollbar;\n        let cellNum = Math.floor((saveData.tableEndTime - saveData.tableStartTime) / setting.widthTime);\n        $this.find('.sc_header_cell').width(setting.dataWidth);\n        $this.find('.sc_data,.sc_data_scroll').width(setting.dataWidth);\n        $this.find('.sc_header').width(scMainWidth);\n        $this.find('.sc_main_box').width(scMainWidth);\n        $this.find('.sc_header_scroll').width(setting.widthTimeX * cellNum);\n        $this.find('.sc_main_scroll').width(setting.widthTimeX * cellNum);\n      });\n    },\n    /**\n     * move all cells of the right of the specified time line cell\n     *\n     * @param timeline\n     * @param baseTimeLineCell\n     * @param moveWidth\n     */\n    _moveSchedules: function (timeline, baseTimeLineCell, moveWidth) {\n      return this.each(function () {\n        let $this = $(this);\n        let setting = methods._loadSettingData.apply($this);\n        let saveData = methods._loadData.apply($this);\n        let $barList = $this.find('.sc_main .timeline').eq(timeline).find('.sc_bar');\n        for (let i = 0; i < $barList.length; i++) {\n          let $bar = $($barList[i]);\n          if (baseTimeLineCell.position().left <= $bar.position().left) {\n            let v1 = $bar.position().left + setting.widthTimeX * moveWidth;\n            let v2 = Math.floor((saveData.tableEndTime - saveData.tableStartTime) / setting.widthTime) * setting.widthTimeX - $bar.outerWidth();\n            $bar.css({\n              left: Math.max(0, Math.min(v1, v2))\n            });\n            let scKey = $bar.data('sc_key');\n            let start = saveData.tableStartTime + Math.floor($bar.position().left / setting.widthTimeX) * setting.widthTime;\n            let end = start + (saveData.schedule[scKey].end - saveData.schedule[scKey].start);\n            saveData.schedule[scKey].start = methods.formatTime(start);\n            saveData.schedule[scKey].end = methods.formatTime(end);\n            saveData.schedule[scKey].startTime = start;\n            saveData.schedule[scKey].endTime = end;\n            methods._rewriteBarText.apply($this, [$bar, saveData.schedule[scKey]]);\n\n            // if setting\n            if (setting.onChange) {\n              setting.onChange.apply($this, [$bar, saveData.schedule[scKey]]);\n            }\n          }\n        }\n        methods._resetBarPosition.apply($this, [timeline]);\n      });\n    },\n    /**\n     * initialize\n     */\n    init: function (options) {\n      return this.each(function () {\n        let $this = $(this);\n        let config = $.extend({\n          className: 'jq-schedule',\n          rows: {},\n          startTime: '07:00',\n          endTime: '19:30',\n          widthTimeX: 25,\n          // 1cell辺りの幅(px)\n          widthTime: 600,\n          // 区切り時間(秒)\n          timeLineY: 50,\n          // timeline height(px)\n          timeLineBorder: 1,\n          // timeline height border\n          timeBorder: 1,\n          // border width\n          timeLinePaddingTop: 0,\n          timeLinePaddingBottom: 0,\n          headTimeBorder: 1,\n          // time border width\n          dataWidth: 160,\n          // data width\n          verticalScrollbar: 0,\n          // vertical scrollbar width\n          bundleMoveWidth: 1,\n          // width to move all schedules to the right of the clicked time cell\n          draggable: true,\n          resizable: true,\n          resizableLeft: false,\n          // event\n          onInitRow: null,\n          onChange: null,\n          onClick: null,\n          onAppendRow: null,\n          onAppendSchedule: null,\n          onScheduleClick: null\n        }, options);\n        methods._saveSettingData.apply($this, [config]);\n        let tableStartTime = methods.calcStringTime(config.startTime);\n        let tableEndTime = methods.calcStringTime(config.endTime);\n        tableStartTime -= tableStartTime % config.widthTime;\n        tableEndTime -= tableEndTime % config.widthTime;\n        methods._saveData.apply($this, [{\n          tableStartTime: tableStartTime,\n          tableEndTime: tableEndTime\n        }]);\n        let html = '' + '<div class=\"sc_menu\">' + '\\n' + '<div class=\"sc_header_cell\"><span>&nbsp;</span></div>' + '\\n' + '<div class=\"sc_header\">' + '\\n' + '<div class=\"sc_header_scroll\"></div>' + '\\n' + '</div>' + '\\n' + '</div>' + '\\n' + '<div class=\"sc_wrapper\">' + '\\n' + '<div class=\"sc_data\">' + '\\n' + '<div class=\"sc_data_scroll\"></div>' + '\\n' + '</div>' + '\\n' + '<div class=\"sc_main_box\">' + '\\n' + '<div class=\"sc_main_scroll\">' + '\\n' + '<div class=\"sc_main\"></div>' + '\\n' + '</div>' + '\\n' + '</div>' + '\\n' + '</div>';\n        $this.append(html);\n        $this.addClass(config.className);\n        $this.find('.sc_main_box').on('scroll', function () {\n          $this.find('.sc_data_scroll').css('top', $(this).scrollTop() * -1);\n          $this.find('.sc_header_scroll').css('left', $(this).scrollLeft() * -1);\n        });\n        // add time cell\n        // var cellNum = Math.floor((tableEndTime - tableStartTime) / config.widthTime);\n        let beforeTime = -1;\n        for (let t = tableStartTime; t < tableEndTime; t += config.widthTime) {\n          if (beforeTime < 0 || Math.floor(beforeTime / 3600) !== Math.floor(t / 3600)) {\n            html = '';\n            html += '<div class=\"sc_time\">' + methods.formatTime(t) + '</div>';\n            let $time = $(html);\n            let cn = Number(Math.min(Math.ceil((t + config.widthTime) / 3600) * 3600, tableEndTime) - t);\n            let cellNum = Math.floor(cn / config.widthTime);\n            $time.width(cellNum * config.widthTimeX);\n            $this.find('.sc_header_scroll').append($time);\n            beforeTime = t;\n          }\n        }\n        $(window).on('resize', function () {\n          methods._resizeWindow.apply($this);\n        }).trigger('resize');\n\n        // addrow\n        for (let i in config.rows) {\n          methods._addRow.apply($this, [i, config.rows[i]]);\n        }\n      });\n    }\n  };\n  /**\n   *\n   * @param {Object|string} method\n   * @returns {jQuery|methods|*}\n   */\n  // eslint-disable-next-line no-param-reassign\n  $.fn.timeSchedule = function (method) {\n    // Method calling logic\n    if (methods[method]) {\n      return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));\n      // eslint-disable-next-line no-else-return\n    } else if (typeof method === 'object' || !method) {\n      return methods.init.apply(this, arguments);\n    }\n    $.error('Method ' + method + ' does not exist on jQuery.timeSchedule');\n    return this;\n  };\n})(jQuery);"],"names":["$","PLUGIN_NAME","methods","calcStringTime","str","slice","split","Number","formatTime","val","let","i1","Math","floor","_saveSettingData","data","this","_loadSettingData","_saveData","d","extend","tableStartTime","tableEndTime","schedule","timeline","_loadData","scheduleData","$this","saveData","apply","timelineData","i","push","resetData","each","find","remove","_resizeRow","addSchedule","start","end","startTime","endTime","text","_addScheduleData","_resetBarPosition","addRow","_addRow","resetRowData","height","setRows","setDraggable","enable","setting","draggable","setResizable","resizable","_getTimeLineNumber","node","top","num","n","tn","ceil","timeLineY","timeLinePaddingTop","timeLinePaddingBottom","rows","r","tr","length","max","_addScheduleBgData","st","widthTime","et","$bar","css","left","widthTimeX","width","eq","class","addClass","append","stext","etext","snum","_getScheduleCount","onAppendSchedule","key","on","onClick","$n","scKey","$node","currentNode","resizableHandles","grid","containment","helper","event","ui","offsetTop","position","offsetLeft","currentTop","currentLeft","nowTimeline","drag","$moveNode","timelineNum","_rewriteBarText","stop","x","onChange","resizableLeft","handles","join","timeBorder","minWidth","resize","ev","element","size","w","outerWidth","row","id","html","$data","$timeline","title","subtitle","onInitRow","t","$tl","onScheduleClick","bdata","s","e","droppable","accept","drop","nowTimelineNum","index","appendTo","onAppendRow","c1","s1","s2","e1","$barList","codes","check","h","$e1","$e2","code","sort","a","b","next","j","c2","outerHeight","timeLineBorder","closest","_resizeWindow","scMainWidth","dataWidth","verticalScrollbar","cellNum","_moveSchedules","baseTimeLineCell","moveWidth","v1","v2","min","init","options","config","className","headTimeBorder","bundleMoveWidth","scrollTop","scrollLeft","beforeTime","$time","cn","window","trigger","fn","timeSchedule","method","Array","prototype","call","arguments","error","jQuery"],"mappings":"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"}